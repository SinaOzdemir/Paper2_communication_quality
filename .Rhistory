pacman::p_load(packs)
pacman::p_load(character = packs)
pacman::p_load(char = packs)
#test with spacyR
spacy_initialize()
glimpse(data$tweet_text.en)
View(data)
# This indicator should be combined with policy related tweets indicator
# later on in order to pin-point political responsibility reporting.
data_eng<- data %>% filter(langlang %in%"en")
View(data_eng)
data_pos<- spacy_parse(x = data$tweet_text,
pos = T,
tag = T,
entity = T,
dependency = T,
nounphrase = T)
View(data_pos)
View(data_eng)
library(tidyverse)
library(Hmisc)
graph.path<- paste0(getwd(),"/plots/")
data.path<-paste0(getwd(),"/data/corpii")
data.eu<-readRDS(file = paste0(data.path,"/EUcorpus_cleaned.RDS"))
data_summary<- Hmisc::contents(data.eu)[[1]] %>% as_tibble(rownames = "var_names")
na_vars<- data_summary %>% filter(NAs >0) %>% pull(var_names) %>% grep(pattern = "is_*",ignore.case = T,perl = T,value = T,x = .)
interactions_summary<- data.eu %>%
group_by(tweet_year) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
left_join(x = .,y = yearly_volume, by = "tweet_year") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), ~(./n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
colnames(data.eu)
yearly_volume <- sample_data_reduced %>% group_by(tweet_year) %>% tally()
#descriptive data eu:
yearly_volume <- data.eu %>% group_by(tweet_year) %>% tally()
interactions_summary<- data.eu %>%
group_by(tweet_year) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
left_join(x = .,y = yearly_volume, by = "tweet_year") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), ~(./n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
typeof(data.eu$is_retweet)
data.eu<- data.eu %>% mutate(across(matches("is_*"),~as.numeric(.x)))
typeof(data.eu$is_retweet)
class(data.eu$is_retweet)
interactions_summary<- data.eu %>%
group_by(tweet_year) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
left_join(x = .,y = yearly_volume, by = "tweet_year") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), ~(./n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
yearly_interactivity<- interactions_summary %>%
ggplot(data=.,aes(x = tweet_year, y = share)) +
geom_bar(aes(fill = share),stat = "identity",position = "dodge")+facet_wrap(~variable)
yearly_interactivity
View(data_summary)
View(interactions_summary)
yearly_interactivity<- interactions_summary %>%
ggplot(data=.,aes(x = tweet_year, y = share)) +
geom_bar(aes(fill = share),stat = "identity",position = "dodge")+theme_minimal()+
facet_wrap(~variable)+
labs(x = "Year","Share",title = "EU verified accounts interactivity rate",subtitle = "N accounts = 115 \n N tweets = 1065203")
yearly_interactivity
ggsave(filename = "yearly_interaction_rate",plot = yearly_interactivity,device = ".jpeg",path = graph.path)
ggsave(filename = "yearly_interaction_rate",plot = yearly_interactivity,device = "jpeg",path = graph.path)
yearly_interactivity
yearly_interactivity<- interactions_summary %>%
ggplot(data=.,aes(x = tweet_year, y = share)) +
geom_bar(aes(fill = share),stat = "identity",position = "dodge")+theme_minimal()+
facet_wrap(~variable)+
labs(x = "Year",y = "Share",title = "EU verified accounts interactivity rate",subtitle = "N accounts = 115 \n N tweets = 1065203")
ggsave(filename = "yearly_interaction_rate",plot = yearly_interactivity,device = "jpeg",path = graph.path)
yearly_interactivity
colnames(data.eu)
#between accounts comparison of interactivity
eu_acc_vol <- data.eu %>% group_by(user_username) %>% tally()
#between accounts comparison of interactivity
eu_acc_vol <- data.eu %>% group_by(user_username) %>% tally(name = "tweet_n")
View(eu_acc_vol)
glimpse("user_name")
glimpse(data.eu$user_name)
#between accounts comparison of interactivity
eu_acc_vol <- data.eu %>% group_by(user_name) %>% tally(name = "tweet_n")
eu_intr_comp <- data.eu %>%
group_by(user_name) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
right_join(x = .,y = eu_acc_vol, by = "user_name")
View(eu_intr_comp)
eu_intr_comp <- data.eu %>%
group_by(user_name) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
right_join(x = .,y = eu_acc_vol, by = "user_name") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), ~(./n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
View(eu_intr_comp)
class(eu_intr_comp$yearly_quote_share)
eu_intr_comp <- data.eu %>%
group_by(user_name) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
right_join(x = .,y = eu_acc_vol, by = "user_name") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), ~(./n))
eu_intr_comp <- data.eu %>%
group_by(user_name) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
right_join(x = .,y = eu_acc_vol, by = "user_name") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), ~(.x/n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
eu_intr_comp <- data.eu %>%
group_by(user_name) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
right_join(x = .,y = eu_acc_vol, by = "user_name")
View(eu_intr_comp)
eu_intr_comp$yearly_retweet_share
eu_intr_comp$yearly_retweet_share/eu_intr_comp$tweet_n
eu_intr_comp <- data.eu %>%
group_by(user_name) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
right_join(x = .,y = eu_acc_vol, by = "user_name") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), (./n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
eu_intr_comp <- data.eu %>%
group_by(user_name) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
right_join(x = .,y = eu_acc_vol, by = "user_name") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")),~(./tweet_n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
View(eu_intr_comp)
quantile(eu_intr_comp$share)
eu_intr_comp <- data.eu %>%
group_by(user_name) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
right_join(x = .,y = eu_acc_vol, by = "user_name") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")),~(./tweet_n))
eu_intr_quote <- eu_intr_comp %>%
filter(yearly_quote_share >= quantile(yearly_quote_share, .75)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
View(eu_intr_quote)
eu_intr_quote <- eu_intr_comp %>%
filter(yearly_quote_share >= quantile(yearly_quote_share, .9)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
eu_intr_retweet <-eu_intr_comp %>%
filter(yearly_retweet_share >= quantile(yearly_retweet_share, .9)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
eu_intr_comp <- data.eu %>%
group_by(user_name) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
right_join(x = .,y = eu_acc_vol, by = "user_name") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")),~(./tweet_n))
View(eu_intr_comp)
eu_intr_retweet_p<- eu_intr_comp %>% ggplot(aes(x= user_name,y =yearly_retweet_share))+geom_point()
eu_intr_retweet_p
eu_intr_retweet_p<- eu_intr_comp %>% ggplot(aes(x= user_name,y =yearly_retweet_share))+
geom_point(aes(color = yearly_retweet_share))+
theme_minimal()+geom_text(aes(label = user_name),hjust = 0, vjust = 0)+theme(axis.ticks.x = element_blank()
eu_intr_retweet_p<- eu_intr_comp %>% ggplot(aes(x= user_name,y =yearly_retweet_share))+
geom_point(aes(color = yearly_retweet_share))+
theme_minimal()+geom_text(aes(label = user_name),hjust = 0, vjust = 0)+theme(axis.ticks.x = element_blank())
eu_intr_retweet_p
eu_intr_retweet_p<- eu_intr_comp %>% ggplot(aes(x= user_name,y =yearly_retweet_share))+
geom_point(aes(color = yearly_retweet_share))+
theme_minimal()+geom_text(aes(label = user_name),hjust = 0, vjust = 0)+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme_minimal()+
labs(x= "",y = "Share", title = "Retweet of EU accounts",subtitle = "Normalized by total number of tweets")
eu_intr_retweet_p
eu_intr_retweet_p<- eu_intr_comp %>% ggplot(aes(x= user_name,y =yearly_retweet_share))+
geom_point(aes(color = yearly_retweet_share))+
theme_minimal()+geom_text(aes(label = user_name),hjust = 0, vjust = 0)+
theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
theme_minimal()+
labs(y = "Share", title = "Retweet of EU accounts",subtitle = "Normalized by total number of tweets")
eu_intr_retweet_p
eu_intr_retweet_p<- eu_intr_comp %>% ggplot(aes(x= user_name,y =yearly_retweet_share))+
geom_point(aes(color = yearly_retweet_share))+
theme_minimal()+geom_text(aes(label = user_name),hjust = 0, vjust = 0)+
scale_x_discrete(labels = NULL, breaks = NULL) +
theme_minimal()+
labs(x = "",y = "Share", title = "Retweet of EU accounts",subtitle = "Normalized by total number of tweets")
eu_intr_retweet_p
ggsave(filename = "inter_account_retweet",plot = eu_intr_retweet_p,device = "jpeg",path = graph.path)
ggsave(filename = "yearly_interaction_rate.jpeg",plot = yearly_interactivity,path = graph.path)
ggsave(filename = "inter_account_retweet.jpeg",plot = eu_intr_retweet_p,device = "jpeg",path = graph.path)
ggsave(filename = "inter_account_retweet.jpeg",plot = eu_intr_retweet_p,path = graph.path)
#this looks ugly as hell in export, need to readjust dimensions
ggsave(filename = "inter_account_retweet.jpeg",plot = eu_intr_retweet_p,path = graph.path,units = "cm",width = 100,height = 100)
#this looks ugly as hell in export, need to readjust dimensions
ggsave(filename = "inter_account_retweet.jpeg",plot = eu_intr_retweet_p,path = graph.path,units = "cm",width = 20,height = 15)
eu_intr_reply_p<- eu_intr_comp %>% ggplot(aes(x= user_name,y =yearly_reply_share))+
geom_point(aes(color = yearly_reply_share))+
theme_minimal()+geom_text(aes(label = user_name),hjust = 0, vjust = 0)+
scale_x_discrete(labels = NULL, breaks = NULL) +
theme_minimal()+
labs(x = "",y = "Share", title = "Reply by EU accounts",subtitle = "Normalized by total number of tweets")
eu_intr_reply_p
eu_intr_quote_p <- eu_intr_comp %>% ggplot(aes(x= user_name,y =yearly_quote_share))+
geom_point(aes(color = yearly_quote_share))+
theme_minimal()+geom_text(aes(label = user_name),hjust = 0, vjust = 0)+
scale_x_discrete(labels = NULL, breaks = NULL) +
theme_minimal()+
labs(x = "",y = "Share", title = "Quotes by EU accounts",subtitle = "Normalized by total number of tweets")
eu_intr_quote_p
#so they are not big on replying except for EU trade and Commissioner for aggriculture
ggsave(filename = "inter_account_reply.jpeg",plot = eu_intr_reply_p,path = graph.path,units = "cm",width = 20,height = 15)
#they don't seem to be big on quoting in general either.
ggsave(filename = "inter_account_quote.jpeg",plot = eu_intr_quote_p,path = graph.path,units = "cm",width = 20,height = 15)
library(tidyverse)
data.path<- paste0(getwd(),"/data/corpii/")
a<-readxl::read_xlsx(path = file.choose(),sheet = 1)
View(a)
#metadata from api
b<- readRDS(file = file.choose())
colnames(b)
colnames(a)
a<- a %>% select(Actor_name:Actor_role,user_id,screen_name)
unique(a$Actor_type)
a_executive<- a %>% filter(Actor_type %in% c("Agency","Commissioner","Deputy director general","Director general","Directorate general","Executive vice-president","High representative and vice president","President","Vice president","Institution"))
a_executive<- a %>% filter(!Actor_type %in% c("MEP","Party group","Political Party"))
unique(a_executive$Actor_type)
a_executive<- a %>% filter(!Actor_type %in% c("MEP","Party group","Political party"))
View(a_executive)
a_executive<- a %>% filter(!Actor_type %in% c("MEP",
"Party group",
"Political party",
"Head of State"))
View(a_executive)
c<-a_executive %>% filter(!user_id%in%b$user_id)
View(c)
View(b)
View(a_executive)
View(c)
colnames(a)
c<- left_join(b,a,by = user_id,screen_name)
c<- left_join(b,a,by = c("user_id","screen_name"))
View(c)
library(writexl)
library(xlsx)
install.packages("xlsx")
library(xlsx)
View(c)
write.table(x = c, file = "eu_handcoded_meta.txt",sep = ",",dec = ".",fileEncoding = "UTF-8")
write.table(x = c, file = "eu_handcoded_meta.txt",sep = ",",dec = ".",fileEncoding = "UTF-8",row.names = F)
c$user_id<-paste0("x",c$user_id)
View(c)
write.table(x = c, file = "./data/Accounts/eu_handcoded_meta.txt",sep = ",",dec = ".",fileEncoding = "UTF-8",row.names = F)
d<- c[!duplicated(c$user_id),]
View(d)
write.table(x = d,
file = "./data/Accounts/eu_handcoded_meta.txt",
sep = ",",
dec = ".",
fileEncoding = "UTF-8",
row.names = F)
#######delete later########
#handcoded metadata
a<-readxl::read_xlsx(path = file.choose(),sheet = 1)
saveRDS(a, file = "./data/Accounts/EU_handcoded_meta.RDS")
data.path<- paste0(getwd(),"/data/")
meta.data<- readRDS(paste0(data.path,"/Accounts/EU_handcoded_meta.RDS"))
data.text<- readRDS(paste0(data.path,"/corpii/EUTweetLanguageIndicators.RDS"))
data.corpus<- readRDS(paste0(data.path,"/corpii/EUcorpus_cleaned.RDS"))
colnames(meta.data)
meta.data.imp<- meta.data %>% select(user_id,screen_name,Actor_type:Actor_role)
colnames(data.corpus)
colnames(data.text)
duplicated(data.text$tweet_id)
data.analysis<- left_join(data.corpus, data.text, by = c("tweet_id","author_id"))
data.analysis<- left_join(data.corpus, data.text, by = c("tweet_id"))
data.analysis.dup<- data.analysis[duplicated(data.analysis$tweet_id),]
summary.data<- Hmisc::contents(data.analysis.dup)[[1]] %>% as_tibble(rownames = "var.names")
View(summary.data)
#text indicator script created duplicated tweets...
data.analysis<- inner_join(data.corpus, data.text, by = c("tweet_id"))
#text indicator script created duplicated tweets...
data.analysis<- left_join(data.corpus, data.text, by = c("tweet_id"))
data.analysis.unique<- data.analysis[!duplicated(data.analysis$tweet_id),]
data.raw<- readRDS(paste0(data.path,"corpii/EU_corpus.RDS"))
colnames(meta.data.imp)
colnames(data.analysis.unique)
data.analysis.final <- meta.data.imp %>%
rename(author_id = user_id, user_screenname = screen_name) %>%
right_join(x = .,data.analysis.unique, by = c("author_id","user_screenname"))
data.analysis.final <- meta.data.imp %>%
rename(author_id = user_id, user_username = screen_name) %>%
right_join(x = .,data.analysis.unique, by = c("author_id","user_screenname"))
data.analysis.final <- meta.data.imp %>%
rename(author_id = user_id, user_username = screen_name) %>%
right_join(x = .,data.analysis.unique, by = c("author_id","user_username"))
saveRDS(data.analysis.final, file = "./data/corpii/EU_analysis_data.RDS")
data.analysis.final <- meta.data.imp %>%
rename(author_id = user_id, user_username = screen_name) %>%
right_join(x = .,data.analysis.unique, by = c("author_id","user_username")) %>%
select(-tweet_text.en.y) %>% rename(tweet_text.en = tweet_text.en.x)
colnames(data.analysis.final)
saveRDS(data.analysis.final, file = "./data/corpii/EU_analysis_data.RDS")
data.eu<- readRDS(file = "./data/corpii/EU_analysis_data.RDS")
getwd()
packs<- c("tidyverse","igraph","kableExtra")
library(pacman)
pacman::p_load(char = packs)
data.eu<- readRDS(file = paste0(getwd(),"/data/corpii/EU_analysis_data.RDS"))
data.path<-paste0(getwd(),"/data/corpii/")
data.path
setwd("C:/Users/sinaoz/OneDrive - NTNU/Projects/communication_quality_repo")
data.eu<- readRDS(file = "C:/Users/sinaoz/OneDrive - NTNU/Projects/communication_quality_repo/data/corpii/")
data.eu<- readRDS(file = "C:/Users/sinaoz/OneDrive - NTNU/Projects/communication_quality_repo/data/corpii/EU_analysis_data.RDS")
yearly_volume <- data.eu %>% group_by(tweet_year) %>% tally()
#all columns are saved as character to ensure homogeneity in earlier processes
#now we need a few things as numeric
data.eu<- data.eu %>% mutate(across(matches("is_*"),~as.numeric(.x)))
eu_interactions_summary<- data.eu %>%
group_by(tweet_year) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
left_join(x = .,y = yearly_volume, by = "tweet_year") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), ~(./n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
yearly_interactivity<- eu_interactions_summary %>%
ggplot(data=.,aes(x = tweet_year, y = share)) +
geom_bar(aes(fill = share),stat = "identity",position = "dodge")+theme_minimal()+
facet_wrap(~variable)+
labs(x = "Year",y = "Share",title = "EU verified accounts interactivity rate",subtitle = "N accounts = 115 \n N tweets = 1065203")
yearly_interactivity
volume_by_type<- data.eu %>% group_by(Actor_type) %>% tally(name = "tweet_n")
View(volume_by_type)
glimpse(data.eu$Actor_type)
unique(data.eu$user_username)
data.path<- paste0(getwd(),"/data/")
data.path<- paste0(getwd(),"/data/")
data.path
meta.data<- readRDS(paste0(data.path,"Accounts/EU_handcoded_meta.RDS"))
View(meta.data)
data.text<- readRDS(paste0(data.path,"corpii/EUTweetLanguageIndicators.RDS"))
data.corpus<- readRDS(paste0(data.path,"corpii/EUcorpus_cleaned.RDS"))
meta.data.imp<- meta.data %>% select(user_id,screen_name,Actor_type:Actor_role)
colnames(meta.data.imp)
#text indicator script created duplicated tweets...
data.analysis<- left_join(data.corpus, data.text, by = c("tweet_id"))
data.analysis.unique<- data.analysis[!duplicated(data.analysis$tweet_id),]
conames(data.analysis.unique)
colnames(data.analysis.unique)
meta.data.imp <- meta.data.imp %>%
rename(author_id = user_id, user_username = screen_name)
View(meta.data.imp)
meta.data.imp <- meta.data.imp %>%
rename(author_id = user_id, user_username = screen_name) %>%
mutate(tweet_id = gsub("x","",.x))
meta.data.imp <- meta.data.imp %>%
rename(author_id = user_id, user_username = screen_name) %>%
mutate(author_id = gsub("x","",.x))
meta.data.imp<- meta.data %>% select(user_id,screen_name,Actor_type:Actor_role)
meta.data.imp <- meta.data.imp %>%
rename(author_id = user_id, user_username = screen_name) %>%
mutate(author_id = gsub("x","",.x))
meta.data.imp <- meta.data.imp %>%
rename(author_id = user_id, user_username = screen_name) %>%
mutate(author_id = gsub("x","",author_id))
View(meta.data.imp)
data.analysis.final<- left_join(data.analysis.unique,meta.data.imp, by = c("author_id","user_username"))
glimpse(data.analysis.final$Actor_type)
saveRDS(data.analysis.final, file = "./data/corpii/EU_analysis_data.RDS")
knitr::opts_chunk$set(echo = TRUE)
packs<- c("tidyverse","igraph","kableExtra")
library(pacman)
pacman::p_load(char = packs)
data.eu<- readRDS(file = "C:/Users/sinaoz/OneDrive - NTNU/Projects/communication_quality_repo/data/corpii/EU_analysis_data.RDS")
#data.io<- readRDS()
#data.uk<- readRDS()
yearly_volume <- data.eu %>% group_by(tweet_year) %>% tally()
#all columns are saved as character to ensure homogeneity in earlier processes
#now we need a few things as numeric
data.eu<- data.eu %>% mutate(across(matches("is_*"),~as.numeric(.x)))
eu_interactions_summary<- data.eu %>%
group_by(tweet_year) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
left_join(x = .,y = yearly_volume, by = "tweet_year") %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), ~(./n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
yearly_interactivity<- eu_interactions_summary %>%
ggplot(data=.,aes(x = tweet_year, y = share)) +
geom_bar(aes(fill = share),stat = "identity",position = "dodge")+theme_minimal()+
facet_wrap(~variable)+
labs(x = "Year",y = "Share",title = "EU verified accounts interactivity rate",subtitle = "N accounts = 115 \n N tweets = 1062742")
yearly_interactivity
volume_by_type<- data.eu %>% group_by(Actor_type) %>% tally(name = "tweet_n")
act_type_interactivity<- data.eu %>%
group_by(Actor_type,tweet_year) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply)))
View(act_type_interactivity)
volume_by_type_year<- data.eu %>% group_by(Actor_type,tweet_year) %>% tally(name = "tweet_n")
act_type_interactivity<- data.eu %>%
group_by(Actor_type,tweet_year) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
left_join(x = .,y = yearly_volume, by = c("Actor_type","tweet_year")) %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), ~(./tweet_n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
act_type_interactivity<- data.eu %>%
group_by(Actor_type,tweet_year) %>%
summarise(yearly_retweet_share = (sum(is_retweet)),
yearly_quote_share = (sum(is_quote)),
yearly_reply_share = (sum(is_reply))) %>%
left_join(x = .,y = volume_by_type_year, by = c("Actor_type","tweet_year")) %>%
mutate_at(vars(c("yearly_retweet_share","yearly_quote_share","yearly_reply_share")), ~(./tweet_n)) %>%
pivot_longer(cols = starts_with("yearly_"),names_to = "variable",values_to = "share")
View(act_type_interactivity)
act_type_interactivity %>% ggplot(aes(x=tweet_year,y = share))+geom_bar(aes(fill = Actor_type),stat = "identity",position = "dodge")+theme_minimal()+facet_wrap(~variable)
View(act_type_interactivity)
library(tidyverse)
library(Hmisc)
data.path<-paste0(getwd(),"/data/corpii")
library(academictwitteR)
data.path<-paste0(getwd(),"/data/corpii")
graph.path<- paste0(getwd(),"/plots/")
data.eu<-readRDS(file = paste0(data.path,"/EUcorpus_cleaned.RDS"))
replies<- data.eu %>% filter(is_reply == 1)
colnames(replies)
View(replies)
eu_corpus<- readRDS(paste0(data.path,"/EU_corpus.RDS"))
eu_corpus<- readRDS(file.choose())
eu_corpus<- readRDS(file.choose())
View(eu_corpus)
View(eu_corpus[[17]][[465]])
eu.data.path<- "C:/Users/sinaf/OneDrive - NTNU/Projects/communication_quality_repo/data/EU/rds/"
eu.data.list<- list.files(path = eu.data.path, pattern = "*.RDS",full.names = T)
eu.full.data<- map_dfr(eu.data.list,readRDS)
colnames(eu.full.data)
eu.recipients<- eu.full.data %>% select(authord_id,user_name,tweet_in_reply_to_user_id)
eu.recipients<- eu.full.data %>% select(author_id,user_name,tweet_in_reply_to_user_id)
eu.data.path<- "C:/Users/sinaf/OneDrive - NTNU/Projects/communication_quality_repo/data/EU/rds/"
eu.data.list<- list.files(path = eu.data.path, pattern = "*.RDS",full.names = T) %>% select(tweet_id,author_id,tweet_in_reply_to_user_id)
library(tidyverse)
library(Hmisc)
library(academictwitteR)
data.path<-paste0(getwd(),"/data/corpii")
graph.path<- paste0(getwd(),"/plots/")
data.eu<-readRDS(file = paste0(data.path,"/EUcorpus_cleaned.RDS"))
library(igraph)
remove(data.eu)
eu.data.path<- "C:/Users/sinaf/OneDrive - NTNU/Projects/communication_quality_repo/data/EU/rds/"
eu.data.list<- list.files(path = eu.data.path, pattern = "*.RDS",full.names = T) %>% select(author_id,tweet_in_reply_to_user_id)
eu.data.list<- list.files(path = eu.data.path, pattern = "*.RDS",full.names = T)
eu.reply.network<- map_dfr(eu.data.list, readRDS) %>% select(author_id,tweet_in_reply_to_user_id)
eu.edge.list<- eu.reply.network %>% group_by(author_id,tweet_in_reply_to_user_id) %>% summarise(weight = n())
View(eu.edge.list)
eu.edge.list<- eu.reply.network %>% group_by(author_id,tweet_in_reply_to_user_id) %>% summarise(weight = n()) %>% arrange(weight)
View(eu.edge.list)
eu.edge.list<- eu.reply.network %>% group_by(author_id,tweet_in_reply_to_user_id) %>% summarise(weight = n()) %>% arrange(desc(weight))
View(eu.edge.list)
eu.edge.list<- eu.reply.network %>% group_by(author_id,tweet_in_reply_to_user_id) %>% summarise(weight = n()) %>% drop_na(tweet_in_reply_to_user_id) %>% arrange(desc(weight))
View(eu.edge.list)
eu.node.list<- eu.edge.list %>% pivot_longer(names_to = "variable", values_to = "value")
eu.node.list<- eu.edge.list %>% pivot_longer(cols = everything(),names_to = "variable", values_to = "value")
colnames(eu.node.list)
colnames(eu.edge.list)
eu.edge.list<- eu.reply.network %>%
group_by(author_id,tweet_in_reply_to_user_id) %>%
summarise(weight = n()) %>%
drop_na(tweet_in_reply_to_user_id) %>%
arrange(desc(weight)) %>% rename(author_id = from, tweet_in_reply_to_user_id = to)
eu.edge.list<- eu.reply.network %>%
group_by(author_id,tweet_in_reply_to_user_id) %>%
summarise(weight = n()) %>%
drop_na(tweet_in_reply_to_user_id) %>%
arrange(desc(weight)) %>% rename(from = author_id , to =  tweet_in_reply_to_user_id)
View(eu.edge.list)
eu.node.list<- eu.edge.list %>% pivot_longer(cols = c("from","to"),names_to = "variable", values_to = "value")
View(eu.node.list)
eu.node.list<- eu.edge.list %>%
pivot_longer(cols = c("from","to"),names_to = "variable", values_to = "labels") %>% select(labels)
View(eu.node.list)
network.dta<-graph_from_data_frame(d = eu.edge.list,vertices = eu.node.list,directed = T)
eu.node.list<- eu.edge.list %>%
pivot_longer(cols = c("from","to"),names_to = "variable", values_to = "labels") %>%
select(labels) %>%
distinct(labels)
network.dta<-graph_from_data_frame(d = eu.edge.list,vertices = eu.node.list,directed = T)
plot(network.dta)
